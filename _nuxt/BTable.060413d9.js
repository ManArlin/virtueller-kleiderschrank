import{u as S}from"./useBooleanish.b2afd79a.js";import"./useBreadcrumb.ef185003.js";import{o as ne,g as Ie,p as $e,h as De,q as Te,v as ce,m as Ee,w as ue}from"./dom.08632105.js";import{c as Fe,a as x}from"./object.6cb5f5ed.js";import{_ as Ve}from"./BSpinner.vue_vue_type_script_setup_true_lang.03e3840d.js";import{_ as Ae}from"./BTableSimple.vue_vue_type_script_setup_true_lang.62777ab0.js";import{k as G,d as He,R as Re,v as B,j as C,x as H,l as Me,o as d,c as Ne,w as je,a as p,K as w,S as I,u as l,n as y,e as K,t as R,s as M,q,F as T,b as Le,I as _e,J as Oe,N as W}from"./entry.662d088a.js";const Ue=["TD","TH","TR"],ze=["a","a *","button","button *","input:not(.disabled):not([disabled])","select:not(.disabled):not([disabled])","textarea:not(.disabled):not([disabled])",'[role="link"]','[role="link"] *','[role="button"]','[role="button"] *',"[tabindex]:not(.disabled):not([disabled])"].join(","),J=h=>{if(!h||!h.target)return!1;const f=h.target;if("disabled"in f&&f.disabled||Ue.indexOf(f.tagName)!==-1)return!1;if(ne(".dropdown-menu",f))return!0;const u=f.tagName==="LABEL"?f:ne("label",f);if(u){const s=Ie(u,"for"),L=s?$e(s):De("input, select, textarea",u);if(L&&!L.disabled)return!0}return Te(f,ze)},Ke=()=>{const h=(o,b)=>{const n=[];return!(o!=null&&o.length)&&(b==null?void 0:b.length)?(Object.keys(b[0]).forEach(c=>n.push({key:c,label:ce(c)})),n):(Array.isArray(o)&&o.forEach(c=>{typeof c=="string"?n.push({key:c,label:ce(c)}):Ee(c)&&c.key&&typeof c.key=="string"&&n.push({...c})}),n)},f=G([]),u=(o,b,n,c)=>(f.value=Fe(b),"isFilterableTable"in c&&c.isFilterableTable.value===!0&&n.filter&&(f.value=P(f.value,n.filter,n.filterable)),"isSortable"in c&&c.isSortable.value===!0&&(f.value=L(o,f.value,{key:n.sortBy,desc:c.sortDescBoolean.value},n.sortCompare)),f.value),s=G(void 0),L=(o,b,n,c)=>{if(!n||!n.key)return b;const F=n.key;return b.sort((V,m)=>{if(c!==void 0)return c(V,m,n.key,n.desc);const N=_=>typeof _=="object"?JSON.stringify(_):_;return N(V[F])>N(m[F])?n.desc?-1:1:N(m[F])>N(V[F])?n.desc?1:-1:0})},P=(o,b,n)=>o.filter(c=>Object.entries(c).filter(F=>{const[V,m]=F;return!m||V[0]==="_"||n.length>0&&!n.includes(V)?!1:(typeof m=="object"?JSON.stringify(Object.values(m)):typeof m=="string"?m:m.toString()).toLowerCase().includes(b.toLowerCase())}).length>0);return{normaliseFields:h,mapItems:u,internalItems:f,updateInternalItems:async o=>{try{return f.value=await x(o),f.value}catch{return}},filterEvent:s,notifyFilteredItems:()=>{s.value&&s.value(f.value)},formatItem:(o,b)=>{const n=o[b.key];return b.formatter&&typeof b.formatter=="function"?b.formatter(n,b.key,o):o[b.key]}}},qe=["title","abbr","onClick"],We={class:"d-inline-flex flex-nowrap align-items-center gap-1"},Je={key:1},Ge=["onClick","onDblclick","onMouseenter","onMouseleave"],Qe={key:0,class:"b-table-stacked-label"},Xe=["colspan"],Ye=["colspan"],Ze={class:"d-flex align-items-center justify-content-center gap-2"},xe=p("strong",null,"Loading...",-1),et={key:1,class:"b-table-empty-slot"},tt=["colspan"],st={key:0},at=["title","abbr","onClick"],lt={key:1},ot={key:2},rt={key:3},bt=He({__name:"BTable",props:{align:null,caption:null,captionTop:{default:!1},borderless:{default:!1},bordered:{default:!1},borderVariant:null,dark:{default:!1},fields:{default:()=>[]},footClone:{default:!1},hover:{default:!1},items:{default:()=>[]},provider:null,sortCompare:null,noProvider:null,noProviderPaging:null,noProviderSorting:null,noProviderFiltering:null,responsive:{type:[Boolean,String],default:!1},small:{default:!1},striped:{default:!1},stacked:{type:[Boolean,String],default:!1},labelStacked:{type:Boolean,default:!1},variant:null,sortBy:null,sortDesc:{default:!1},sortInternal:{default:!0},selectable:{default:!1},stickySelect:{default:!1},selectHead:{type:[Boolean,String],default:!0},selectMode:{default:"single"},selectionVariant:{default:"primary"},stickyHeader:{default:!1},busy:{default:!1},showEmpty:{default:!1},perPage:null,currentPage:{default:1},filter:null,filterable:null,emptyText:{default:"There are no records to show"},emptyFilteredText:{default:"There are no records matching your request"}},emits:["headClicked","rowClicked","rowDblClicked","rowHovered","rowUnhovered","rowSelected","rowUnselected","selection","update:busy","update:sortBy","update:sortDesc","sorted","filtered"],setup(h,{expose:f,emit:u}){const s=h,L=Re(),P=Ke(),ee=S(B(s,"footClone")),E=S(B(s,"sortDesc")),te=S(B(s,"sortInternal")),o=S(B(s,"selectable")),b=S(B(s,"stickySelect")),n=S(B(s,"labelStacked")),c=S(B(s,"busy")),F=S(B(s,"showEmpty")),V=S(B(s,"noProviderPaging")),m=S(B(s,"noProviderSorting")),N=S(B(s,"noProviderFiltering")),g=G(c.value);P.filterEvent.value=async e=>{if(O.value){await Y();return}const a=await x(e);u("filtered",a)};const v=G(new Set([])),_=C(()=>v.value.size>0),ie=C(()=>({[`align-${s.align}`]:s.align!==void 0,"b-table-selectable":o.value,[`b-table-select-${s.selectMode}`]:o.value,"b-table-selecting user-select-none":o.value&&_.value,"b-table-busy":g.value,"b-table-sortable":$.value,"b-table-sort-desc":$.value&&E.value===!0,"b-table-sort-asc":$.value&&E.value===!1})),de=C(()=>({bordered:s.bordered,borderless:s.borderless,borderVariant:s.borderVariant,captionTop:s.captionTop,dark:s.dark,hover:s.hover,responsive:s.responsive,striped:s.striped,stacked:s.stacked,small:s.small,tableClass:ie.value,tableVariant:s.variant,stickyHeader:s.stickyHeader})),A=C(()=>P.normaliseFields(s.fields,s.items)),Q=C(()=>A.value.length+(o.value?1:0)),X=C(()=>s.filter!==void 0&&s.filter!==""),O=C(()=>s.provider!==void 0),se=C(()=>o.value&&(!!s.selectHead||L.selectHead!==void 0)),$=C(()=>s.fields.filter(e=>typeof e=="string"?!1:e.sortable).length>0),ve=C(()=>$.value&&te.value===!0),D=C(()=>{const e=O.value?P.internalItems.value:ve.value?P.mapItems(s.fields,s.items,s,{isSortable:$,isFilterableTable:X,sortDescBoolean:E}):s.items;if(s.perPage!==void 0){const a=(s.currentPage-1)*s.perPage;return e.splice(a,s.perPage)}return e}),ae=e=>typeof e=="string"?ue(e):e.label!==void 0?e.label:typeof e.key=="string"?ue(e.key):e.key,le=(e,a,r=!1)=>{const t=typeof e=="string"?e:e.key;u("headClicked",t,e,a,r),ke(e)},ye=(e,a,r)=>{u("rowClicked",e,a,r),ge(e,a,r.shiftKey)},be=(e,a,r)=>u("rowDblClicked",e,a,r),fe=(e,a,r)=>u("rowHovered",e,a,r),he=(e,a,r)=>u("rowUnhovered",e,a,r),ke=e=>{if(!$.value)return;const a=typeof e=="string"?e:e.key,r=typeof e=="string"?!1:e.sortable;if($.value===!0&&r===!0){const t=!E.value;a!==s.sortBy&&u("update:sortBy",a),u("update:sortDesc",t),u("sorted",a,t)}},U=()=>{!o.value||u("selection",Array.from(v.value))},ge=(e,a,r=!1)=>{if(!!o.value){if(v.value.has(e))v.value.delete(e),u("rowUnselected",e);else if(s.selectMode==="single"&&v.value.size>0&&(v.value.forEach(t=>u("rowUnselected",t)),v.value.clear()),s.selectMode==="range"&&v.value.size>0&&r){const t=Array.from(v.value).pop(),k=D.value.findIndex(j=>j===t),i=Math.min(k,a),Z=Math.max(k,a);D.value.slice(i,Z+1).forEach(j=>{v.value.has(j)||(v.value.add(j),u("rowSelected",j))})}else v.value.add(e),u("rowSelected",e);U()}},Y=async()=>{if(!O.value||!s.provider||g.value)return;g.value=!0;const e=new Proxy({currentPage:s.currentPage,filter:s.filter,sortBy:s.sortBy,sortDesc:s.sortDesc,perPage:s.perPage},{get(r,t){return t in r?r[t]:void 0},set(){return console.error("BTable provider context is a read-only object."),!0}}),a=s.provider(e,P.updateInternalItems);if(a!==void 0){if(a instanceof Promise)try{const r=await a;return Array.isArray(r)?await P.updateInternalItems(r):void 0}finally{g.value&&(g.value=!1)}try{return await P.updateInternalItems(a)}finally{g.value&&(g.value=!1)}}},oe=e=>{e._showDetails=!e._showDetails},pe=e=>[e.class,e.thClass,e.variant?`table-${e.variant}`:void 0,{"b-table-sortable-column":$.value&&e.sortable,"b-table-sticky-column":e.stickyColumn}],me=(e,a)=>[e.class,e.tdClass,e.variant?`table-${e.variant}`:void 0,(a==null?void 0:a._cellVariants)&&(a==null?void 0:a._cellVariants[e.key])?`table-${a==null?void 0:a._cellVariants[e.key]}`:void 0,{"b-table-sticky-column":e.stickyColumn}],re=e=>[e._rowVariant?`table-${e._rowVariant}`:null,e._rowVariant?`table-${e._rowVariant}`:null,o.value&&v.value.has(e)?`selected table-${s.selectionVariant}`:null],we=()=>{if(!o.value)return;const e=v.value.size>0?Array.from(v.value):[];v.value=new Set([...D.value]),v.value.forEach(a=>{e.includes(a)||u("rowSelected",a)}),U()},Pe=()=>{!o.value||(v.value.forEach(e=>{u("rowUnselected",e)}),v.value=new Set([]),U())},Se=e=>{if(!o.value)return;const a=D.value[e];!a||v.value.has(a)||(v.value.add(a),u("rowSelected",a),U())},Be=e=>{if(!o.value)return;const a=D.value[e];!a||!v.value.has(a)||(v.value.delete(a),u("rowUnselected",a),U())},z=async(e,a,r)=>{if(a===r)return;const t=Ce=>s.noProvider&&s.noProvider.includes(Ce),k=!["currentPage","perPage"].includes(e),i=["currentPage","perPage"].includes(e)&&(t("paging")||V.value===!0),Z=["filter"].includes(e)&&(t("filtering")||N.value===!0),j=["sortBy","sortDesc"].includes(e)&&(t("sorting")||m.value===!0);i||Z||j||(await Y(),k&&P.notifyFilteredItems())};return H(()=>s.filter,(e,a)=>{e===a||O.value||e||x(s.items).then(r=>u("filtered",r))}),H(()=>g.value,()=>g.value!==c.value&&u("update:busy",g.value)),H(()=>c.value,()=>g.value!==c.value&&(g.value=c.value)),H(()=>s.filter,(e,a)=>z("filter",e,a)),H(()=>s.currentPage,(e,a)=>z("currentPage",e,a)),H(()=>s.perPage,(e,a)=>z("perPage",e,a)),H(()=>s.sortBy,(e,a)=>z("sortBy",e,a)),H(()=>s.sortDesc,(e,a)=>z("sortDesc",e,a)),Me(()=>{O.value&&Y()}),f({selectAllRows:we,clearSelected:Pe,selectRow:Se,unselectRow:Be}),(e,a)=>(d(),Ne(Ae,_e(Oe(l(de))),{default:je(()=>{var r;return[p("thead",null,[e.$slots["thead-top"]?w(e.$slots,"thead-top",{key:0}):I("",!0),p("tr",null,[l(se)?(d(),y("th",{key:0,class:M(["b-table-selection-column",{"b-table-sticky-column":l(b)}])},[w(e.$slots,"select-head",{},()=>[K(R(typeof h.selectHead=="boolean"?"Selected":h.selectHead),1)])],2)):I("",!0),(d(!0),y(T,null,q(l(A),t=>(d(),y("th",W({key:t.key,scope:"col",class:pe(t),title:t.headerTitle,abbr:t.headerAbbr,style:t.thStyle},t.thAttr,{onClick:k=>le(t,k)}),[p("div",We,[w(e.$slots,"sort-icon",{field:t,sortBy:h.sortBy,selected:t.key===h.sortBy,isDesc:l(E),direction:l(E)?"desc":"asc"},()=>[l($)&&t.sortable?(d(),y("span",{key:0,class:M(["b-table-sort-icon",{sorted:t.key===h.sortBy,[`sorted-${l(E)?"desc":"asc"}`]:t.key===h.sortBy}])},null,2)):I("",!0)]),p("div",null,[e.$slots["head("+t.key+")"]||e.$slots["head()"]?w(e.$slots,e.$slots["head("+t.key+")"]?"head("+t.key+")":"head()",{key:0,label:t.label}):(d(),y(T,{key:1},[K(R(ae(t)),1)],64))])])],16,qe))),128))]),e.$slots["thead-sub"]?(d(),y("tr",Je,[(d(!0),y(T,null,q(l(A),t=>(d(),y("td",{key:t.key,scope:"col",class:M([t.class,t.thClass,t.variant?`table-${t.variant}`:""])},[e.$slots["thead-sub"]?w(e.$slots,"thead-sub",W({key:0,items:l(A)},t)):(d(),y(T,{key:1},[K(R(t.label),1)],64))],2))),128))])):I("",!0)]),p("tbody",null,[(d(!0),y(T,null,q(l(D),(t,k)=>(d(),y(T,{key:k},[p("tr",{class:M(re(t)),onClick:i=>!l(J)(i)&&ye(t,k,i),onDblclick:i=>!l(J)(i)&&be(t,k,i),onMouseenter:i=>!l(J)(i)&&fe(t,k,i),onMouseleave:i=>!l(J)(i)&&he(t,k,i)},[l(se)?(d(),y("td",{key:0,class:M(["b-table-selection-column",{"b-table-sticky-column":l(b)}])},[w(e.$slots,"select-cell",{},()=>[p("span",{class:M(v.value.has(t)?"text-primary":"")},"\u{1F5F9}",2)])],2)):I("",!0),(d(!0),y(T,null,q(l(A),i=>(d(),y("td",W({key:i.key},i.tdAttr,{class:me(i,t)}),[h.stacked&&l(n)?(d(),y("label",Qe,R(ae(i)),1)):I("",!0),e.$slots["cell("+i.key+")"]||e.$slots["cell()"]?w(e.$slots,e.$slots["cell("+i.key+")"]?"cell("+i.key+")":"cell()",{key:1,value:t[i.key],index:k,item:t,field:i,items:h.items,toggleDetails:()=>oe(t),detailsShowing:t._showDetails}):(d(),y(T,{key:2},[K(R(l(P).formatItem(t,i)),1)],64))],16))),128))],42,Ge),t._showDetails===!0&&e.$slots["row-details"]?(d(),y("tr",{key:0,class:M(re(t))},[p("td",{colspan:l(Q)},[w(e.$slots,"row-details",{item:t,toggleDetails:()=>oe(t)})],8,Xe)],2)):I("",!0)],64))),128)),g.value?(d(),y("tr",{key:0,class:M(["b-table-busy-slot",{"b-table-static-busy":l(D).length==0}])},[p("td",{colspan:l(Q)},[w(e.$slots,"table-busy",{},()=>[p("div",Ze,[Le(Ve,{class:"align-middle"}),xe])])],8,Ye)],2)):I("",!0),l(F)&&l(D).length===0?(d(),y("tr",et,[p("td",{colspan:l(Q)},[w(e.$slots,"empty",{items:l(D),filtered:l(X)},()=>[K(R(l(X)?h.emptyFilteredText:h.emptyText),1)])],8,tt)])):I("",!0)]),l(ee)?(d(),y("tfoot",st,[p("tr",null,[(d(!0),y(T,null,q(l(A),t=>(d(),y("th",W({key:t.key},t.thAttr,{scope:"col",class:[t.class,t.thClass,t.variant?`table-${t.variant}`:""],title:t.headerTitle,abbr:t.headerAbbr,style:t.thStyle,onClick:k=>le(t,k,!0)}),R(t.label),17,at))),128))])])):e.$slots["custom-foot"]?(d(),y("tfoot",lt,[w(e.$slots,"custom-foot",{fields:l(A),items:h.items,columns:(r=l(A))==null?void 0:r.length})])):I("",!0),e.$slots["table-caption"]?(d(),y("caption",ot,[w(e.$slots,"table-caption")])):h.caption?(d(),y("caption",rt,R(h.caption),1)):I("",!0)]}),_:3},16))}});export{bt as default};
